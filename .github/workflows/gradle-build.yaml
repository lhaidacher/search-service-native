name: Java CI with Gradle

on:
  push:
    branches: [ feature_github-actions-example ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source code
        uses: actions/checkout@v2
      - name: Install GraalVM
        uses: ayltai/setup-graalvm@v1
        with:
          java-version: 11
          graalvm-version: 20.1.0
          native-image: true
      - name: Build native executable
        uses: eskatos/gradle-command-action@v1
        with:
          arguments: build -Dquarkus.package.type=native
      - name: Build and push Docker images
        uses: docker/build-push-action@v1
        with:
          #username: $GITHUB_ACTOR
          username: Github-user
          #password: ${{ secrets.GITHUB_TOKEN }}
          password: Test123456
          #registry: docker.pkg.github.com
          registry: harbor.lhaidacher.com/onlineshop
          #repository: lhaidacher/search-service/search-service
          repository: search-service
          tag_with_sha: true
